<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
	</head>
	
	<body>
	  	<script src="/static/js/ngl.2.0.0-dev.33.js"></script>
	  	
	  	
		<form method="POST" action="/">
			{{ form.csrf_token }}
		    {{ form.pdb_id(size=4) }} 
		    <input type="submit" value="Submit">		    
		</form>
	  	
	 	 <script>
	 		document.addEventListener("DOMContentLoaded", function (o) {
	     		var stage = new NGL.Stage("viewport");
	     		stage.loadFile("rcsb://{{pdb_id}}", {defaultRepresentation: true});//, {color: schemeID}
	     		stage.setParameters({backgroundColor:"lightgrey"});
			});
	 		
	    	
	    	
	    	// create tooltip element and add to the viewer canvas
	    	var tooltip = document.createElement("div");
	    	Object.assign(tooltip.style, {
	    	  display: "none",
	    	  position: "absolute",
	    	  zIndex: 10,
	    	  pointerEvents: "none",
	    	  backgroundColor: "rgba(0, 0, 0, 0.6)",
	    	  color: "lightgrey",
	    	  padding: "0.5em",
	    	  fontFamily: "sans-serif"
	    	});
	    	stage.viewer.container.appendChild(tooltip);

	    	// listen to `hovered` signal to move tooltip around and change its text
	    	stage.signals.hovered.add(function (pickingProxy) {
	    	  if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)){
	    	    var atom = pickingProxy.atom || pickingProxy.closestBondAtom;
	    	    var cp = pickingProxy.canvasPosition;
	    	    tooltip.innerText = "ATOM: " + atom.qualifiedName();
	    	    tooltip.style.bottom = cp.y + 3 + "px";
	    	    tooltip.style.left = cp.x + 3 + "px";
	    	    tooltip.style.display = "block";
	    	  }else{
	    	    tooltip.style.display = "none";
	    	  }
	    	});
	  	</script>
	  	
	    <div id="viewport" style="width:1000px; height:800px; float:right;"></div>
		
	</body>
	
	</html>